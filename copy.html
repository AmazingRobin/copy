<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>copy</title>
</head>

<body>
  <script>
    // 隐藏复制功能
    var copyDomain = {
      init: function() {
        // 给屏幕设置一个点击事件，来复制文本，复制成功后删除事件，不影响页面内其他点击事件
        document.addEventListener('mouseup', copyDomain.toCopy, true);
      },
      domainList: {
        'ios': [ // 域名或者相关文本配置列表
          'http://www.baidu.com/ios',
          'http://www.google.com/ios',
          'http://www.douban.com/ios',
          'http://www.qq.com/ios',
          'http://www.163.com/ios'
        ],
        'android': [
          'http://www.baidu.com/and',
          'http://www.google.com/and',
          'http://www.douban.com/and',
          'http://www.qq.com/and',
          'http://www.163.com/and'
        ]
      },
      toCopy: function() {
        var now = (new Date()).getTime();
        var currentIdx = 0;
        var lastClick = localStorage.getItem('copytime');
        if (lastClick) {
          // 点击过
          var clickArr = lastClick.split('|');
          currentIdx = parseInt(clickArr[1]);
          if (parseInt(clickArr[0]) - now > (1000 * 60 * 60)) { // 可以修改为5秒或其他间隔时间做测试
            // 距离上次点击超过1小时
            currentIdx++;
            if (currentIdx >= copyDomain.domainList.length) {
              currentIdx = 0
            }
            localStorage.setItem('copytime', now + '|' + currentIdx);
          }
        } else {
          // 第一次点击
          localStorage.setItem('copytime', now + '|0');
        }

        if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
          window.getSelection().removeAllRanges();
          var ele = document.createElement('div'); // ios生成div标签内容来复制
          ele.setAttribute('id', 'copyele');
          ele.setAttribute('style', 'opacity:0');
          ele.innerHTML = copyDomain.domainList['ios'][currentIdx]
          document.body.append(ele);

          var tar = document.getElementById("copyele");
          var range = document.createRange();
          range.selectNode(tar);
          window.getSelection().addRange(range);
          var successful = document.execCommand('copy');
          window.getSelection().removeAllRanges();
          document.getElementById('copyele').remove();
          console.log('复制成功'); // 不需要可以删除
        } else {
          var ele = document.createElement('input'); // 安卓生成input标签来复制
          ele.setAttribute('id', 'copyele');
          ele.setAttribute('style', 'opacity:0');
          ele.setAttribute('value', copyDomain.domainList['android'][currentIdx]);
          document.body.append(ele);

          var tar = document.getElementById('copyele');
          tar.select();
          document.execCommand('Copy');
          document.getElementById('copyele').remove()
          console.log('复制成功'); // 不需要可以删除
        }
        document.removeEventListener('mouseup', copyDomain.toCopy, true);
      }
    }

    copyDomain.init()

  </script>
</body>

</html>
